library(jsonlite)
trainSet <- read_file(./train.json) %>%
fromJSON()
library(tidyverse)
library(jsonlite)
trainSet <- read_file(./train.json) %>%
fromJSON()
library(tidyverse)
library(jsonlite)
trainSet <- read_file(train.json) %>%
fromJSON()
library(tidyverse)
library(jsonlite)
trainSet <- read_file(/train.json) %>%
library(tidyverse)
library(jsonlite)
trainSet <- read_file("./train.json") %>%
fromJSON()
testSet <- read_file("./test.json") %>%
fromJSON()
dim(trainSet)
names(trainSet)
trainSet$ingredients[[1]]
library(tidytext)
install.packages("tidytext")
library(tidytext)
library(tidyverse)
library(jsonlite)
trainSet <- read_file("./train.json") %>%
fromJSON()
testSet <- read_file("./test.json") %>%
fromJSON()
dim(trainSet)
names(trainSet)
trainSet$ingredients[[1]]
trainSet %>%
unnest(columnName)
library(tidytext)
library(tidyverse)
library(jsonlite)
trainSet <- read_file("./train.json") %>%
fromJSON()
testSet <- read_file("./test.json") %>%
fromJSON()
dim(trainSet)
names(trainSet)
trainSet$ingredients[[1]]
trainSet %>%
unnest(c("id", "cuisine", "ingredient"))
library(tidytext)
library(tidyverse)
library(jsonlite)
trainSet <- read_file("./train.json") %>%
fromJSON()
testSet <- read_file("./test.json") %>%
fromJSON()
dim(trainSet)
names(trainSet)
trainSet$ingredients[[1]]
trainSet %>%
unnest(c("id", "cuisine", "ingredients"))
library(tidytext)
library(tidyverse)
library(jsonlite)
trainSet <- read_file("./train.json") %>%
fromJSON()
testSet <- read_file("./test.json") %>%
fromJSON()
dim(trainSet)
names(trainSet)
trainSet$ingredients[[1]]
trainSet %>%
unnest(c("id", "cuisine", "ingredients"))
testSet %>%
unnest(c("id", "cuisine", "ingredients"))
library(tidytext)
library(tidyverse)
library(jsonlite)
trainSet <- read_file("./train.json") %>%
fromJSON()
testSet <- read_file("./test.json") %>%
fromJSON()
dim(testSet)
dim(trainSet)
names(testSet)
names(trainSet)
trainSet$ingredients[[1]]
trainSet %>%
unnest(c("id", "cuisine", "ingredients"))
testSet %>%
unnest(c("id", "cuisine", "ingredients"))
library(tidytext)
library(tidyverse)
library(jsonlite)
trainSet <- read_file("./train.json") %>%
fromJSON()
testSet <- read_file("./test.json") %>%
fromJSON()
dim(testSet)
dim(trainSet)
names(testSet)
names(trainSet)
trainSet$ingredients[[1]]
trainSet %>%
unnest(c("id", "cuisine", "ingredients"))
testSet %>%
unnest(c("id", "ingredients"))
# ============================================================
# Load libraries
# ============================================================
library(tidyverse)
library(tidytext)
library(tidymodels)
library(jsonlite)
library(glmnet)
# ============================================================
# Load JSON Files
# ============================================================
trainSet <- read_file("./train.json") %>% fromJSON()
testSet  <- read_file("./test.json") %>% fromJSON()
# ============================================================
# Unnest ingredients
# ============================================================
train_long <- trainSet %>%
unnest(ingredients)
test_long <- testSet %>%
unnest(ingredients)
# ============================================================
# Collapse ingredients into a single text string per recipe
# ============================================================
train_doc <- train_long %>%
group_by(id, cuisine) %>%
summarise(
text = paste(ingredients, collapse = " "),
.groups = "drop"
)
test_doc <- test_long %>%
group_by(id) %>%
summarise(
text = paste(ingredients, collapse = " "),
.groups = "drop"
)
# ============================================================
# Create recipe: tokenize → filter → tf-idf
# ============================================================
recipe_cuisine <- recipe(cuisine ~ text, data = train_doc) %>%
step_tokenize(text) %>%
step_tokenfilter(text, max_tokens = 3000) %>%   # limit vocabulary
step_tfidf(text)
install.packages("textrecipes")
# ============================================================
# Load libraries
# ============================================================
library(tidyverse)
library(tidytext)
library(tidymodels)
library(jsonlite)
library(glmnet)
library(textrecipes)
# ============================================================
# Load JSON Files
# ============================================================
trainSet <- read_file("./train.json") %>% fromJSON()
testSet  <- read_file("./test.json") %>% fromJSON()
# ============================================================
# Unnest ingredients
# ============================================================
train_long <- trainSet %>%
unnest(ingredients)
test_long <- testSet %>%
unnest(ingredients)
# ============================================================
# Collapse ingredients into a single text string per recipe
# ============================================================
train_doc <- train_long %>%
group_by(id, cuisine) %>%
summarise(
text = paste(ingredients, collapse = " "),
.groups = "drop"
)
test_doc <- test_long %>%
group_by(id) %>%
summarise(
text = paste(ingredients, collapse = " "),
.groups = "drop"
)
# ============================================================
# Create recipe: tokenize → filter → tf-idf
# ============================================================
recipe_cuisine <- recipe(cuisine ~ text, data = train_doc) %>%
step_tokenize(text) %>%
step_tokenfilter(text, max_tokens = 3000) %>%   # limit vocabulary
step_tfidf(text)
# ============================================================
# Model: Regularized multinomial logistic regression (glmnet)
# ============================================================
model_spec <- multinom_reg(
penalty = 0.01,
mixture = 1
) %>%
set_engine("glmnet")
# ============================================================
# Workflow
# ============================================================
workflow_cuisine <- workflow() %>%
add_recipe(recipe_cuisine) %>%
add_model(model_spec)
# ============================================================
# Fit model
# ============================================================
fit_cuisine <- workflow_cuisine %>%
fit(data = train_doc)
# ============================================================
# Predict on test set
# ============================================================
test_predictions <- predict(fit_cuisine, new_data = test_doc)
# ============================================================
# Create Kaggle submission file
# ============================================================
submission <- test_doc %>%
bind_cols(test_predictions) %>%
select(id, .pred_class) %>%
rename(cuisine = .pred_class)
write_csv(submission, "submission.csv")
# ============================================================
# Message
# ============================================================
cat("submission.csv created successfully!\n")
